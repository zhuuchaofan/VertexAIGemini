@* 单条消息气泡组件 *@

<div class="@(IsUser ? "flex justify-end" : "flex justify-start")">
    <div class="max-w-[90%] @(IsUser
        ? "bg-gradient-to-r from-amber-500 to-orange-500 text-white rounded-2xl rounded-br-md"
        : "bg-white border border-amber-200 text-gray-800 rounded-2xl rounded-bl-md shadow-sm") px-3 py-2">

        @if (!IsUser && ThinkingContent?.Length > 0)
        {
            <details class="mb-2 group">
                <summary class="cursor-pointer text-xs text-amber-700">思考过程 (@ThinkingContent.Length 字符)</summary>
                <div class="mt-2 pl-3 text-xs text-amber-800 border-l-2 border-amber-300 whitespace-pre-wrap">@ThinkingContent</div>
            </details>
        }

        @if (IsUser)
        {
            <div class="whitespace-pre-wrap break-words text-sm">@Content</div>
        }
        else
        {
            <div class="markdown-body text-sm">
                @((MarkupString)MarkdownHtml)
                @if (IsStreaming)
                {
                    <span class="inline-block w-2 h-4 bg-amber-600 ml-1 cursor-blink"></span>
                }
            </div>
        }
    </div>
</div>

@code {
    [Parameter] public bool IsUser { get; set; }
    [Parameter] public string Content { get; set; } = "";
    [Parameter] public string? ThinkingContent { get; set; }
    [Parameter] public bool IsStreaming { get; set; }
    [Parameter] public string MarkdownHtml { get; set; } = "";
}
